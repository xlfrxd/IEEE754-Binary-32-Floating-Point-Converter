<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IEEE-754 Binary-32 Converter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
        }
        .container {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        button {
            width: 100%;
            padding: 10px;
            background: #000;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background: #333;
        }
        button#saveButton {
            background: #28a745;
            cursor: not-allowed;
            display: none; /* Initially hidden */
        }
        button#saveButton.enabled {
            cursor: pointer;
            display: block; /* Show when enabled */
        }
        button#saveButton:hover {
            background: #218838;
        }
        .output {
            margin-top: 20px;
            padding: 10px;
            background: #e9ecef;
            border-radius: 4px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>IEEE-754 Binary-32 Converter</h2>
    <div class="form-group">
        <label for="inputType">Input Type:</label>
        <select id="inputType" onchange="toggleInputFields()">
            <option value="binary">Binary Mantissa and Base-2</option>
            <option value="decimal">Decimal Mantissa and Base-10</option>
            <option value="nan">NaN</option>
        </select>
    </div>
    <div id="binaryInputFields" class="form-group">
        <label for="binaryInput">Binary Mantissa and Base-2:</label>
        <input type="text" id="binaryMantissa" placeholder="Enter binary mantissa">
        <input type="number" id="binaryExponent" placeholder="Enter base-2 exponent">
    </div>
    <div id="decimalInputFields" class="form-group" style="display: none;">
        <label for="decimalInput">Decimal Mantissa and Base-10:</label>
        <input type="number" id="decimalMantissa" placeholder="Enter decimal mantissa" step="any">
        <input type="number" id="decimalExponent" placeholder="Enter base-10 exponent">
    </div>
    <button id="getResult" onclick="convertIEEE754()">Convert</button>
    <button id="saveButton" onclick="saveToFile()" disabled>Save to File</button>

    <div class="output" id="outputResult">Result will appear here</div>
</div>

<script>
    function toggleInputFields() {
        const inputType = document.getElementById("inputType").value;
        if (inputType === "binary") {
            document.getElementById("binaryInputFields").style.display = "block";
            document.getElementById("decimalInputFields").style.display = "none";
        } else if (inputType === "decimal") {
            document.getElementById("binaryInputFields").style.display = "none";
            document.getElementById("decimalInputFields").style.display = "block";
        } else {
            document.getElementById("binaryInputFields").style.display = "none";
            document.getElementById("decimalInputFields").style.display = "none";
        }
    }

    function convertIEEE754() {
        const inputType = document.getElementById("inputType").value;
        let result = "";

        if (inputType === "binary") {
            const binaryMantissa = document.getElementById("binaryMantissa").value;
            const binaryExponent = parseInt(document.getElementById("binaryExponent").value);

            if (binaryMantissa === "" || isNaN(binaryExponent)) {
                alert("Please enter valid binary mantissa and base-2 exponent.");
                return;
            }

            result = binaryToIEEE754(binaryMantissa, binaryExponent);
        } else if (inputType === "decimal") {
            const decimalMantissa = parseFloat(document.getElementById("decimalMantissa").value);
            const decimalExponent = parseInt(document.getElementById("decimalExponent").value);

            if (isNaN(decimalMantissa) || isNaN(decimalExponent)) {
                alert("Please enter valid decimal mantissa and base-10 exponent.");
                return;
            }

            result = decimalToIEEE754(decimalMantissa, decimalExponent);
        } else {
            result = "NaN";
        }

        document.getElementById("outputResult").innerText = result;

        // Enable the save button
        const saveButton = document.getElementById("saveButton");
        saveButton.classList.add("enabled");
        saveButton.removeAttribute("disabled");
    }

    function binaryToIEEE754(mantissa, exponent) {
        // Convert binary mantissa to decimal
        let decimalMantissa = parseInt(mantissa, 2);

        // Calculate the value
        let value = decimalMantissa * Math.pow(2, exponent);

        // Convert to IEEE-754 format
        let ieee754 = new IEEE754Converter(value);
        return ieee754.toBinary() + " | " + ieee754.toHex();
    }

    function decimalToIEEE754(mantissa, exponent) {
        // Calculate the value
        let value = mantissa * Math.pow(10, exponent);

        // Convert to IEEE-754 format
        let ieee754 = new IEEE754Converter(value);
        return ieee754.toBinary() + " | " + ieee754.toHex();
    }

    function saveToFile() {
        const result = document.getElementById("outputResult").innerText;
        if (result === "" || result === "Result will appear here") {
            alert("No result to save!");
            return;
        }
        const blob = new Blob([result], { type: 'text/plain' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'IEEE754_result.txt';
        link.click();
    }

    class IEEE754Converter {
        constructor(value) {
            this.value = value;
        }

        toBinary() {
            let buffer = new ArrayBuffer(4);
            new Float32Array(buffer)[0] = this.value;
            let binary = Array.prototype.map.call(new Uint8Array(buffer), x => ('00000000' + x.toString(2)).slice(-8)).join('');
            return binary.slice(0, 1) + " " + binary.slice(1, 9) + " " + binary.slice(9);
        }

        toHex() {
            let buffer = new ArrayBuffer(4);
            new Float32Array(buffer)[0] = this.value;
            let hex = Array.prototype.map.call(new Uint8Array(buffer), x => ('00' + x.toString(16)).slice(-2)).join('');
            return hex;
        }
    }
</script>

</body>
</html>
